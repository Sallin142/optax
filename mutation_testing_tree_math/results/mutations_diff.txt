# Mutation Testing Diff File
# Target: optax/tree_utils/_tree_math.py
# Generated: 2026-01-28 10:44:20
# Total Mutations: 114
================================================================================

Mutation #0 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 43
Status: killed

--- original
+++ mutated
@@ -43,1 +43,1 @@
-  trees = [tree_x, tree_y, *other_trees]
+  pass  # SDL mutation

Mutation #1 - RVR: Return Value Replacement: jax.tree.map(lambda *leaves: s to None
File: optax/tree_utils/_tree_math.py
Line: 44
Status: killed

--- original
+++ mutated
@@ -44,1 +44,1 @@
-  return jax.tree.map(lambda *leaves: sum(leaves), *trees)
+  return None

Mutation #2 - RVR: Return Value Replacement: jax.tree.map(operator.sub, tre to None
File: optax/tree_utils/_tree_math.py
Line: 57
Status: killed

--- original
+++ mutated
@@ -57,1 +57,1 @@
-  return jax.tree.map(operator.sub, tree_x, tree_y)
+  return None

Mutation #3 - RVR: Return Value Replacement: jax.tree.map(operator.mul, tre to None
File: optax/tree_utils/_tree_math.py
Line: 70
Status: killed

--- original
+++ mutated
@@ -70,1 +70,1 @@
-  return jax.tree.map(operator.mul, tree_x, tree_y)
+  return None

Mutation #4 - RVR: Return Value Replacement: jax.tree.map(operator.truediv, to None
File: optax/tree_utils/_tree_math.py
Line: 83
Status: killed

--- original
+++ mutated
@@ -83,1 +83,1 @@
-  return jax.tree.map(operator.truediv, tree_x, tree_y)
+  return None

Mutation #5 - RVR: Return Value Replacement: jax.tree.map(lambda x: scalar  to None
File: optax/tree_utils/_tree_math.py
Line: 101
Status: killed

--- original
+++ mutated
@@ -101,1 +101,1 @@
-  return jax.tree.map(lambda x: scalar * x, tree)
+  return None

Mutation #6 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 119
Status: survived

--- original
+++ mutated
@@ -119,1 +119,1 @@
-  scalar = jnp.asarray(scalar)
+  pass  # SDL mutation

Mutation #7 - AOR: Arithmetic Operator Replacement: + to -
File: optax/tree_utils/_tree_math.py
Line: 121
Status: killed

--- original
+++ mutated
@@ -121,1 +121,1 @@
-      lambda x, y: (None if x is None else (x + scalar * y)),
+      lambda x, y: (None if x is None else (x - scalar * y)),

Mutation #8 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 121
Status: killed

--- original
+++ mutated
@@ -121,1 +121,1 @@
-      lambda x, y: (None if x is None else (x + scalar * y)),
+      lambda x, y: (None if not x is None else (x + scalar * y)),

Mutation #9 - RVR: Return Value Replacement: jnp.vdot(a, b, precision=preci to None
File: optax/tree_utils/_tree_math.py
Line: 128
Status: survived

--- original
+++ mutated
@@ -128,1 +128,1 @@
-    return jnp.vdot(a, b, precision=precision)
+    return None

Mutation #10 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 129
Status: killed

--- original
+++ mutated
@@ -129,1 +129,1 @@
-  assert a.shape == b.shape
+  assert a.shape != b.shape

Mutation #11 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 129
Status: killed

--- original
+++ mutated
@@ -129,1 +129,1 @@
-  assert a.shape == b.shape
+  assert a.shape != b.shape

Mutation #12 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 130
Status: killed

--- original
+++ mutated
@@ -130,1 +130,1 @@
-  if jax.dtypes.issubdtype(a.dtype, jnp.complexfloating):
+  if not jax.dtypes.issubdtype(a.dtype, jnp.complexfloating):

Mutation #13 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 134
Status: killed

--- original
+++ mutated
@@ -134,1 +134,1 @@
-  mesh = jax.typeof(a).sharding.mesh
+  pass  # SDL mutation

Mutation #14 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 135
Status: survived

--- original
+++ mutated
@@ -135,1 +135,1 @@
-  if mesh.are_all_axes_explicit:
+  if not mesh.are_all_axes_explicit:

Mutation #15 - RVR: Return Value Replacement: jnp.tensordot(a, b, a.ndim, pr to None
File: optax/tree_utils/_tree_math.py
Line: 139
Status: killed

--- original
+++ mutated
@@ -139,1 +139,1 @@
-  return jnp.tensordot(a, b, a.ndim, precision=precision, out_sharding=sharding)
+  return None

Mutation #16 - RVR: Return Value Replacement: _vdot(jnp.asarray(a), jnp.asar to None
File: optax/tree_utils/_tree_math.py
Line: 143
Status: killed

--- original
+++ mutated
@@ -143,1 +143,1 @@
-  return _vdot(jnp.asarray(a), jnp.asarray(b))
+  return None

Mutation #17 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 168
Status: killed

--- original
+++ mutated
@@ -168,1 +168,1 @@
-  vdots = jax.tree.map(_vdot_safe, tree_x, tree_y)
+  pass  # SDL mutation

Mutation #18 - CRP: Constant Replacement: 0 to 1
File: optax/tree_utils/_tree_math.py
Line: 169
Status: killed

--- original
+++ mutated
@@ -169,1 +169,1 @@
-  return jax.tree.reduce(operator.add, vdots, initializer=0)
+  return jax.tree.reduce(operator.add, vdots, initializer=1)

Mutation #19 - RVR: Return Value Replacement: jax.tree.reduce(operator.add,  to None
File: optax/tree_utils/_tree_math.py
Line: 169
Status: killed

--- original
+++ mutated
@@ -169,1 +169,1 @@
-  return jax.tree.reduce(operator.add, vdots, initializer=0)
+  return None

Mutation #20 - BCR: Boolean Constant Replacement: False to True
File: optax/tree_utils/_tree_math.py
Line: 173
Status: survived

--- original
+++ mutated
@@ -173,1 +173,1 @@
-    tree: Any, associative_reduction: bool = False
+    tree: Any, associative_reduction: bool = True

Mutation #21 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 187
Status: killed

--- original
+++ mutated
@@ -187,1 +187,1 @@
-  sums = jax.tree.map(jnp.sum, tree)
+  pass  # SDL mutation

Mutation #22 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 188
Status: survived

--- original
+++ mutated
@@ -188,1 +188,1 @@
-  if associative_reduction:
+  if not associative_reduction:

Mutation #23 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 190
Status: killed

--- original
+++ mutated
@@ -190,1 +190,1 @@
-    if hasattr(jax.tree, 'reduce_associative'):
+    if not hasattr(jax.tree, 'reduce_associative'):

Mutation #24 - CRP: Constant Replacement: 0 to 1
File: optax/tree_utils/_tree_math.py
Line: 191
Status: survived

--- original
+++ mutated
@@ -191,1 +191,1 @@
-      return jax.tree.reduce_associative(operator.add, sums, identity=0)
+      return jax.tree.reduce_associative(operator.add, sums, identity=1)

Mutation #25 - RVR: Return Value Replacement: jax.tree.reduce_associative(op to None
File: optax/tree_utils/_tree_math.py
Line: 191
Status: killed

--- original
+++ mutated
@@ -191,1 +191,1 @@
-      return jax.tree.reduce_associative(operator.add, sums, identity=0)
+      return None

Mutation #26 - CRP: Constant Replacement: 0 to 1
File: optax/tree_utils/_tree_math.py
Line: 199
Status: killed

--- original
+++ mutated
@@ -199,1 +199,1 @@
-    return jax.tree.reduce(operator.add, sums, initializer=0)
+    return jax.tree.reduce(operator.add, sums, initializer=1)

Mutation #27 - RVR: Return Value Replacement: jax.tree.reduce(operator.add,  to None
File: optax/tree_utils/_tree_math.py
Line: 199
Status: killed

--- original
+++ mutated
@@ -199,1 +199,1 @@
-    return jax.tree.reduce(operator.add, sums, initializer=0)
+    return None

Mutation #28 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 212
Status: killed

--- original
+++ mutated
@@ -212,1 +212,1 @@
-    if jnp.size(array) == 0:
+    if jnp.size(array) != 0:

Mutation #29 - CRP: Constant Replacement: 0 to 1
File: optax/tree_utils/_tree_math.py
Line: 212
Status: killed

--- original
+++ mutated
@@ -212,1 +212,1 @@
-    if jnp.size(array) == 0:
+    if jnp.size(array) == 1:

Mutation #30 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 212
Status: killed

--- original
+++ mutated
@@ -212,1 +212,1 @@
-    if jnp.size(array) == 0:
+    if not jnp.size(array) == 0:

Mutation #31 - RVR: Return Value Replacement: jnp.max(array) to None
File: optax/tree_utils/_tree_math.py
Line: 215
Status: killed

--- original
+++ mutated
@@ -215,1 +215,1 @@
-      return jnp.max(array)
+      return None

Mutation #32 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 216
Status: killed

--- original
+++ mutated
@@ -216,1 +216,1 @@
-  maxes = jax.tree.map(f, tree)
+  pass  # SDL mutation

Mutation #33 - RVR: Return Value Replacement: jax.tree.reduce(jnp.maximum, m to None
File: optax/tree_utils/_tree_math.py
Line: 217
Status: killed

--- original
+++ mutated
@@ -217,1 +217,1 @@
-  return jax.tree.reduce(jnp.maximum, maxes, initializer=-float('inf'))
+  return None

Mutation #34 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 230
Status: killed

--- original
+++ mutated
@@ -230,1 +230,1 @@
-    if jnp.size(array) == 0:
+    if jnp.size(array) != 0:

Mutation #35 - CRP: Constant Replacement: 0 to 1
File: optax/tree_utils/_tree_math.py
Line: 230
Status: killed

--- original
+++ mutated
@@ -230,1 +230,1 @@
-    if jnp.size(array) == 0:
+    if jnp.size(array) == 1:

Mutation #36 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 230
Status: killed

--- original
+++ mutated
@@ -230,1 +230,1 @@
-    if jnp.size(array) == 0:
+    if not jnp.size(array) == 0:

Mutation #37 - RVR: Return Value Replacement: jnp.min(array) to None
File: optax/tree_utils/_tree_math.py
Line: 233
Status: killed

--- original
+++ mutated
@@ -233,1 +233,1 @@
-      return jnp.min(array)
+      return None

Mutation #38 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 234
Status: killed

--- original
+++ mutated
@@ -234,1 +234,1 @@
-  mins = jax.tree.map(f, tree)
+  pass  # SDL mutation

Mutation #39 - RVR: Return Value Replacement: jax.tree.reduce(jnp.minimum, m to None
File: optax/tree_utils/_tree_math.py
Line: 235
Status: killed

--- original
+++ mutated
@@ -235,1 +235,1 @@
-  return jax.tree.reduce(jnp.minimum, mins, initializer=float('inf'))
+  return None

Mutation #40 - RVR: Return Value Replacement: sum(jnp.size(leaf) for leaf in to None
File: optax/tree_utils/_tree_math.py
Line: 247
Status: killed

--- original
+++ mutated
@@ -247,1 +247,1 @@
-  return sum(jnp.size(leaf) for leaf in jax.tree.leaves(tree))
+  return None

Mutation #41 - RVR: Return Value Replacement: jax.tree.map(jnp.conj, tree) to None
File: optax/tree_utils/_tree_math.py
Line: 259
Status: killed

--- original
+++ mutated
@@ -259,1 +259,1 @@
-  return jax.tree.map(jnp.conj, tree)
+  return None

Mutation #42 - RVR: Return Value Replacement: jax.tree.map(jnp.real, tree) to None
File: optax/tree_utils/_tree_math.py
Line: 271
Status: killed

--- original
+++ mutated
@@ -271,1 +271,1 @@
-  return jax.tree.map(jnp.real, tree)
+  return None

Mutation #43 - RVR: Return Value Replacement: jnp.square(leaf.real) + jnp.sq to None
File: optax/tree_utils/_tree_math.py
Line: 275
Status: killed

--- original
+++ mutated
@@ -275,1 +275,1 @@
-  return jnp.square(leaf.real) + jnp.square(leaf.imag)
+  return None

Mutation #44 - AOR: Arithmetic Operator Replacement: - to +
File: optax/tree_utils/_tree_math.py
Line: 279
Status: survived

--- original
+++ mutated
@@ -279,1 +279,1 @@
-              ord: int | str | float | None = None,  # pylint: disable=redefined-builtin
+              ord: int | str | float | None = None,  # pylint: disable=redefined + builtin

Mutation #45 - BCR: Boolean Constant Replacement: False to True
File: optax/tree_utils/_tree_math.py
Line: 280
Status: killed

--- original
+++ mutated
@@ -280,1 +280,1 @@
-              squared: bool = False) -> jax.Array:
+              squared: bool = True) -> jax.Array:

Mutation #46 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 291
Status: killed

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None or ord != 2:

Mutation #47 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 291
Status: killed

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None or ord != 2:

Mutation #48 - LCR: Logical Connector Replacement: or to and
File: optax/tree_utils/_tree_math.py
Line: 291
Status: killed

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None and ord == 2:

Mutation #49 - CRP: Constant Replacement: 2 to 3
File: optax/tree_utils/_tree_math.py
Line: 291
Status: survived

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None or ord == 3:

Mutation #50 - CRP: Constant Replacement: 2 to 1
File: optax/tree_utils/_tree_math.py
Line: 291
Status: killed

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None or ord == 1:

Mutation #51 - CRP: Constant Replacement: 2 to 0
File: optax/tree_utils/_tree_math.py
Line: 291
Status: survived

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None or ord == 0:

Mutation #52 - CRP: Constant Replacement: 2 to -2
File: optax/tree_utils/_tree_math.py
Line: 291
Status: survived

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if ord is None or ord == -2:

Mutation #53 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 291
Status: killed

--- original
+++ mutated
@@ -291,1 +291,1 @@
-  if ord is None or ord == 2:
+  if not ord is None or ord == 2:

Mutation #54 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 293
Status: killed

--- original
+++ mutated
@@ -293,1 +293,1 @@
-    sqnorm = tree_sum(squared_tree)
+    pass  # SDL mutation

Mutation #55 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 294
Status: killed

--- original
+++ mutated
@@ -294,1 +294,1 @@
-    return jnp.array(sqnorm if squared else jnp.sqrt(sqnorm))
+    return jnp.array(sqnorm if not squared else jnp.sqrt(sqnorm))

Mutation #56 - RVR: Return Value Replacement: jnp.array(sqnorm if squared el to None
File: optax/tree_utils/_tree_math.py
Line: 294
Status: killed

--- original
+++ mutated
@@ -294,1 +294,1 @@
-    return jnp.array(sqnorm if squared else jnp.sqrt(sqnorm))
+    return None

Mutation #57 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 295
Status: killed

--- original
+++ mutated
@@ -295,1 +295,1 @@
-  elif ord == 1:
+  elif ord != 1:

Mutation #58 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 295
Status: killed

--- original
+++ mutated
@@ -295,1 +295,1 @@
-  elif ord == 1:
+  elif ord != 1:

Mutation #59 - CRP: Constant Replacement: 1 to 2
File: optax/tree_utils/_tree_math.py
Line: 295
Status: killed

--- original
+++ mutated
@@ -295,1 +295,1 @@
-  elif ord == 1:
+  elif ord == 2:

Mutation #60 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 295
Status: killed

--- original
+++ mutated
@@ -295,1 +295,1 @@
-  elif ord == 1:
+  elif ord == 0:

Mutation #61 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 295
Status: killed

--- original
+++ mutated
@@ -295,1 +295,1 @@
-  elif ord == 1:
+  elif ord == 0:

Mutation #62 - CRP: Constant Replacement: 1 to -1
File: optax/tree_utils/_tree_math.py
Line: 295
Status: killed

--- original
+++ mutated
@@ -295,1 +295,1 @@
-  elif ord == 1:
+  elif ord == -1:

Mutation #63 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 297
Status: killed

--- original
+++ mutated
@@ -297,1 +297,1 @@
-  elif ord == jnp.inf or ord in ('inf', 'infinity'):
+  elif ord != jnp.inf or ord in ('inf', 'infinity'):

Mutation #64 - ROR: Relational Operator Replacement: == to !=
File: optax/tree_utils/_tree_math.py
Line: 297
Status: killed

--- original
+++ mutated
@@ -297,1 +297,1 @@
-  elif ord == jnp.inf or ord in ('inf', 'infinity'):
+  elif ord != jnp.inf or ord in ('inf', 'infinity'):

Mutation #65 - LCR: Logical Connector Replacement: or to and
File: optax/tree_utils/_tree_math.py
Line: 297
Status: killed

--- original
+++ mutated
@@ -297,1 +297,1 @@
-  elif ord == jnp.inf or ord in ('inf', 'infinity'):
+  elif ord == jnp.inf and ord in ('inf', 'infinity'):

Mutation #66 - NCM: Negate Conditionals: remove not from if
File: optax/tree_utils/_tree_math.py
Line: 301
Status: killed

--- original
+++ mutated
@@ -301,1 +301,1 @@
-  return jnp.array(ret if not squared else _square(ret))
+  return jnp.array(ret if squared else _square(ret))

Mutation #67 - RVR: Return Value Replacement: jnp.array(ret if not squared e to None
File: optax/tree_utils/_tree_math.py
Line: 301
Status: killed

--- original
+++ mutated
@@ -301,1 +301,1 @@
-  return jnp.array(ret if not squared else _square(ret))
+  return None

Mutation #68 - RVR: Return Value Replacement: jax.tree.map(lambda x: jnp.zer to None
File: optax/tree_utils/_tree_math.py
Line: 335
Status: killed

--- original
+++ mutated
@@ -335,1 +335,1 @@
-  return jax.tree.map(lambda x: jnp.zeros_like(x, dtype=dtype), tree)
+  return None

Mutation #69 - RVR: Return Value Replacement: jax.tree.map(lambda x: jnp.one to None
File: optax/tree_utils/_tree_math.py
Line: 351
Status: killed

--- original
+++ mutated
@@ -351,1 +351,1 @@
-  return jax.tree.map(lambda x: jnp.ones_like(x, dtype=dtype), tree)
+  return None

Mutation #70 - RVR: Return Value Replacement: jax.tree.map(lambda x: jnp.ful to None
File: optax/tree_utils/_tree_math.py
Line: 369
Status: survived

--- original
+++ mutated
@@ -369,1 +369,1 @@
-  return jax.tree.map(lambda x: jnp.full_like(x, fill_value, dtype=dtype), tree)
+  return None

Mutation #71 - RVR: Return Value Replacement: jax.tree.map(lambda g: jnp.cli to None
File: optax/tree_utils/_tree_math.py
Line: 391
Status: killed

--- original
+++ mutated
@@ -391,1 +391,1 @@
-  return jax.tree.map(lambda g: jnp.clip(g, min_value, max_value), tree)
+  return None

Mutation #72 - CRP: Constant Replacement: 1 to 2
File: optax/tree_utils/_tree_math.py
Line: 398
Status: survived

--- original
+++ mutated
@@ -398,1 +398,1 @@
-          (1 - decay) * (g**order) + decay * t if g is not None else None
+          (2 - decay) * (g**order) + decay * t if g is not None else None

Mutation #73 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 398
Status: survived

--- original
+++ mutated
@@ -398,1 +398,1 @@
-          (1 - decay) * (g**order) + decay * t if g is not None else None
+          (0 - decay) * (g**order) + decay * t if g is not None else None

Mutation #74 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 398
Status: survived

--- original
+++ mutated
@@ -398,1 +398,1 @@
-          (1 - decay) * (g**order) + decay * t if g is not None else None
+          (0 - decay) * (g**order) + decay * t if g is not None else None

Mutation #75 - CRP: Constant Replacement: 1 to -1
File: optax/tree_utils/_tree_math.py
Line: 398
Status: survived

--- original
+++ mutated
@@ -398,1 +398,1 @@
-          (1 - decay) * (g**order) + decay * t if g is not None else None
+          (-1 - decay) * (g**order) + decay * t if g is not None else None

Mutation #76 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 398
Status: killed

--- original
+++ mutated
@@ -398,1 +398,1 @@
-          (1 - decay) * (g**order) + decay * t if g is not None else None
+          (1 - decay) * (g**order) + decay * t if not g is not None else None

Mutation #77 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 410
Status: killed

--- original
+++ mutated
@@ -410,1 +410,1 @@
-          jnp.maximum(jnp.abs(g) + eps, decay * t) if g is not None else g
+          jnp.maximum(jnp.abs(g) + eps, decay * t) if not g is not None else g

Mutation #78 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 422
Status: survived

--- original
+++ mutated
@@ -422,1 +422,1 @@
-    if jnp.isrealobj(g):
+    if not jnp.isrealobj(g):

Mutation #79 - AOR: Arithmetic Operator Replacement: ** to *
File: optax/tree_utils/_tree_math.py
Line: 423
Status: survived

--- original
+++ mutated
@@ -423,1 +423,1 @@
-      return g ** order
+      return g * order

Mutation #80 - RVR: Return Value Replacement: g ** order to None
File: optax/tree_utils/_tree_math.py
Line: 423
Status: survived

--- original
+++ mutated
@@ -423,1 +423,1 @@
-      return g ** order
+      return None

Mutation #81 - AOR: Arithmetic Operator Replacement: / to *
File: optax/tree_utils/_tree_math.py
Line: 425
Status: survived

--- original
+++ mutated
@@ -425,1 +425,1 @@
-    half_order = order / 2
+    half_order = order * 2

Mutation #82 - CRP: Constant Replacement: 2 to 3
File: optax/tree_utils/_tree_math.py
Line: 425
Status: survived

--- original
+++ mutated
@@ -425,1 +425,1 @@
-    half_order = order / 2
+    half_order = order / 3

Mutation #83 - CRP: Constant Replacement: 2 to 1
File: optax/tree_utils/_tree_math.py
Line: 425
Status: survived

--- original
+++ mutated
@@ -425,1 +425,1 @@
-    half_order = order / 2
+    half_order = order / 1

Mutation #84 - CRP: Constant Replacement: 2 to 0
File: optax/tree_utils/_tree_math.py
Line: 425
Status: survived

--- original
+++ mutated
@@ -425,1 +425,1 @@
-    half_order = order / 2
+    half_order = order / 0

Mutation #85 - CRP: Constant Replacement: 2 to -2
File: optax/tree_utils/_tree_math.py
Line: 425
Status: survived

--- original
+++ mutated
@@ -425,1 +425,1 @@
-    half_order = order / 2
+    half_order = order / -2

Mutation #86 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 425
Status: survived

--- original
+++ mutated
@@ -425,1 +425,1 @@
-    half_order = order / 2
+    pass  # SDL mutation

Mutation #87 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 427
Status: survived

--- original
+++ mutated
@@ -427,1 +427,1 @@
-    if half_order.is_integer():
+    if not half_order.is_integer():

Mutation #88 - RVR: Return Value Replacement: numerics.abs_sq(g) ** half_ord to None
File: optax/tree_utils/_tree_math.py
Line: 429
Status: survived

--- original
+++ mutated
@@ -429,1 +429,1 @@
-    return numerics.abs_sq(g) ** half_order
+    return None

Mutation #89 - AOR: Arithmetic Operator Replacement: - to +
File: optax/tree_utils/_tree_math.py
Line: 433
Status: survived

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (1 + decay) * orderth_norm(g) + decay * t if g is not None else None

Mutation #90 - AOR: Arithmetic Operator Replacement: * to /
File: optax/tree_utils/_tree_math.py
Line: 433
Status: survived

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (1 - decay) * orderth_norm(g) + decay / t if g is not None else None

Mutation #91 - CRP: Constant Replacement: 1 to 2
File: optax/tree_utils/_tree_math.py
Line: 433
Status: survived

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (2 - decay) * orderth_norm(g) + decay * t if g is not None else None

Mutation #92 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 433
Status: survived

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (0 - decay) * orderth_norm(g) + decay * t if g is not None else None

Mutation #93 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 433
Status: survived

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (0 - decay) * orderth_norm(g) + decay * t if g is not None else None

Mutation #94 - CRP: Constant Replacement: 1 to -1
File: optax/tree_utils/_tree_math.py
Line: 433
Status: survived

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (-1 - decay) * orderth_norm(g) + decay * t if g is not None else None

Mutation #95 - NCM: Negate Conditionals: add not to if
File: optax/tree_utils/_tree_math.py
Line: 433
Status: killed

--- original
+++ mutated
@@ -433,1 +433,1 @@
-          (1 - decay) * orderth_norm(g) + decay * t if g is not None else None
+          (1 - decay) * orderth_norm(g) + decay * t if not g is not None else None

Mutation #96 - BCR: Boolean Constant Replacement: True to False
File: optax/tree_utils/_tree_math.py
Line: 441
Status: survived

--- original
+++ mutated
@@ -441,1 +441,1 @@
-@functools.partial(jax.jit, inline=True)
+@functools.partial(jax.jit, inline=False)

Mutation #97 - AOR: Arithmetic Operator Replacement: - to +
File: optax/tree_utils/_tree_math.py
Line: 449
Status: survived

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  bias_correction_ = 1 + decay**count

Mutation #98 - AOR: Arithmetic Operator Replacement: ** to *
File: optax/tree_utils/_tree_math.py
Line: 449
Status: survived

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  bias_correction_ = 1 - decay * count

Mutation #99 - CRP: Constant Replacement: 1 to 2
File: optax/tree_utils/_tree_math.py
Line: 449
Status: survived

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  bias_correction_ = 2 - decay**count

Mutation #100 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 449
Status: killed

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  bias_correction_ = 0 - decay**count

Mutation #101 - CRP: Constant Replacement: 1 to 0
File: optax/tree_utils/_tree_math.py
Line: 449
Status: killed

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  bias_correction_ = 0 - decay**count

Mutation #102 - CRP: Constant Replacement: 1 to -1
File: optax/tree_utils/_tree_math.py
Line: 449
Status: survived

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  bias_correction_ = -1 - decay**count

Mutation #103 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 449
Status: killed

--- original
+++ mutated
@@ -449,1 +449,1 @@
-  bias_correction_ = 1 - decay**count
+  pass  # SDL mutation

Mutation #104 - AOR: Arithmetic Operator Replacement: / to *
File: optax/tree_utils/_tree_math.py
Line: 452
Status: survived

--- original
+++ mutated
@@ -452,1 +452,1 @@
-  return jax.tree.map(lambda t: t / bias_correction_.astype(t.dtype), moment)
+  return jax.tree.map(lambda t: t * bias_correction_.astype(t.dtype), moment)

Mutation #105 - RVR: Return Value Replacement: jax.tree.map(lambda t: t / bia to None
File: optax/tree_utils/_tree_math.py
Line: 452
Status: survived

--- original
+++ mutated
@@ -452,1 +452,1 @@
-  return jax.tree.map(lambda t: t / bias_correction_.astype(t.dtype), moment)
+  return None

Mutation #106 - RVR: Return Value Replacement: jax.tree.map(lambda x, y: jnp. to None
File: optax/tree_utils/_tree_math.py
Line: 466
Status: survived

--- original
+++ mutated
@@ -466,1 +466,1 @@
-  return jax.tree.map(lambda x, y: jnp.where(condition, x, y), tree_x, tree_y)
+  return None

Mutation #107 - BCR: Boolean Constant Replacement: False to True
File: optax/tree_utils/_tree_math.py
Line: 474
Status: survived

--- original
+++ mutated
@@ -474,1 +474,1 @@
-    equal_nan: bool = False
+    equal_nan: bool = True

Mutation #108 - RVR: Return Value Replacement: jnp.allclose(a, b, rtol=rtol,  to None
File: optax/tree_utils/_tree_math.py
Line: 491
Status: killed

--- original
+++ mutated
@@ -491,1 +491,1 @@
-    return jnp.allclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan)
+    return None

Mutation #109 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 492
Status: killed

--- original
+++ mutated
@@ -492,1 +492,1 @@
-  tree = jax.tree.map(f, a, b)
+  pass  # SDL mutation

Mutation #110 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 493
Status: killed

--- original
+++ mutated
@@ -493,1 +493,1 @@
-  leaves = jax.tree.leaves(tree)
+  pass  # SDL mutation

Mutation #111 - BCR: Boolean Constant Replacement: True to False
File: optax/tree_utils/_tree_math.py
Line: 494
Status: killed

--- original
+++ mutated
@@ -494,1 +494,1 @@
-  result = functools.reduce(operator.and_, leaves, True)
+  result = functools.reduce(operator.and_, leaves, False)

Mutation #112 - SDL: Statement Deletion: removed assignment
File: optax/tree_utils/_tree_math.py
Line: 494
Status: killed

--- original
+++ mutated
@@ -494,1 +494,1 @@
-  result = functools.reduce(operator.and_, leaves, True)
+  pass  # SDL mutation

Mutation #113 - RVR: Return Value Replacement: result to None
File: optax/tree_utils/_tree_math.py
Line: 495
Status: killed

--- original
+++ mutated
@@ -495,1 +495,1 @@
-  return result
+  return None

